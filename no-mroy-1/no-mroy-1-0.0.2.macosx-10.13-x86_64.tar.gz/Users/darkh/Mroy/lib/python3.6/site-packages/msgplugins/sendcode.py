from Reserver.utils import package
from Reserver.utils import MsgMan
from termcolor import colored
from qlib.data import dbobj
import pdb
import os

DEBUG = os.getenv("DEBUG")

class Msg(dbobj):pass


def onQQMessage(bot, contact, member, content):
    # print(f"{contact} | {member.name} : {content}")

    m =  MsgMan()
    print(colored(contact.name + "|" + member.name, 'green'),end='\r')
    msg_d = contact.__dict__
    msg_d['sendUser'] = member.name
    msg_d['sendQq'] = member.uin
    msg_d['sendNick'] = member.nick
    msg_d['sendType'] = contact.ctype
    msg_d['sendContent'] = content
    msg = Msg(**msg_d)
    m.syncs_msg(msg)

def onPlug(bot):
    print(" -- start plugin  version: 0.0 -- ")
    m =  MsgMan()
    if m.test():
        print("--- server ok ----- ")
    else:
        print(colored("Error Server: "+ m.api, 'red'))
    # m.syncs_msgs(msgs)